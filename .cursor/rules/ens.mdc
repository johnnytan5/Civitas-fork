---
description: ENS Smart Contract Integration & Resolution Rules
globs: **/*.sol, **/*ens*, **/*.ts, **/*.tsx, **/*.js, **/*.py
---
# ENS Integration

When writing code that interacts with the Ethereum Name Service (ENS):

1.  **Reference Documentation:** Always refer to the internal documentation at:
    -   [ENS Smart Contracts](docs/tech/ens/ens-smart-contract.md) (Core contracts, Resolution, Registries)
    -   [ENS Docs](docs/tech/ens/ens-docs.md) (General overview)

2.  **Key Concepts:**
    -   **Resolution:** Process of translating a name to an address (or other record). Uses `Resolver` contracts.
    -   **Namehash:** Names are stored as hashes (nodes). Always normalize names before hashing.
    -   **Normalisation:** Use `ens-normalize` (or standardized library functions like `viem`'s `normalize`).

3.  **Code Patterns:**
    -   Use `IENS` interface for registry interactions.
    -   Check for interface support using `supportsInterface` (EIP-165).
    -   For frontend, prefer `wagmi` hooks (e.g., `useEnsResolver`) or `viem` actions over raw contract calls when possible.

4.  **Verification:**
    -   Ensure names are normalized.
    -   Verify the resolver supports the required interface.
